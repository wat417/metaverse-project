| ディレクトリ / ファイル名 .| 役割概要 .| 確認状況 | 備考 |
|---|---|---|---|
| index.html | SPAのHTMLエントリーポイント。Viteビルド時に`dist/index.html`へ展開される。 | 確認済 ||
| package.json | プロジェクト依存関係・スクリプト・メタ情報定義。Vite/Vue/Firebase等の依存を管理。 | 確認済 ||
| tsconfig.json | TypeScriptコンパイル設定。型解釈・パスエイリアス・strictモードなどを定義。 | 確認済 | `module: "ESNext"` / `types` 未指定（react系未混入） / `typeRoots` 明示により、Vue構成と完全に整合。構成不備なし。 |
| vercel.json | rewrites構成 `/chartTestPage`, `/mainTestPage` | 確認済 | SPAルーティングを包括的に成立させる構成。 |
| vite.config.ts | Viteのビルド・開発サーバー設定。エイリアス・プラグイン・出力構成を含む。 | 確認済 | vue-i18n対応含め、構成は期待通り。 |
| yarn.lock | `yarn`使用時の依存固定ファイル。 | 確認済 | `idb`, `long`, `protobufjs`, `cliui` などに重複バージョンが存在。`yarn-deduplicate` や `resolutions` による整理が必要。React型定義も混入しており、Vue構成に対しては明確な構成不整合。 |
| .github/ || － ||
| .github/workflows/ || － ||
| .github/workflows/deploy.yml | GitHub Pagesへの自動デプロイ構成。mainブランチへのpushをトリガーに、Node.js環境でViteビルド後、distを公開。 | 確認済 | `npm install -g vite` によるグローバルインストールは構成不整合。`package.json` に `vite` が含まれているため、ローカル依存でのビルドが正当。再現性の観点から削除推奨。 |
| dist/ | Viteビルド後の静的成果物配置ディレクトリ。Vercelにデプロイされる対象。 | － | － |
| dist/index.html | SPAエントリーポイント。Viteビルド後に生成され、`#app` にVueがマウントされる。 | 確認済 | `script` / `link` タグに含まれる `assets/*.js` / `*.css` はViteによるハッシュ付き成果物。構成として正常。タイトル・viewport・lang属性も適正。 |
| dist/assets/*.js, *.css | JS/CSS成果物。Vueコンポーネント・ロジック・スタイルがバンドルされる。 | 確認不要 | ビルドの成果物の為 |
| functions/ || － ||
| functions/chatFilter.ts | チャットメッセージのフィルタリングロジック。NGワード・ルール適用処理。 | 確認済 | `filterRules.json` の `enabled` ルールのみ適用。`RegExp(term, 'gi')` による多重一致・マスク処理は構成として妥当。`rulesConfig.mask` の存在チェックが省略されているため、空文字や未定義時の挙動に注意。 |
| functions/filterRules.ts | フィルタルール定義・適用処理。JSONルールの読み込みと適用。 | 確認済 | `rulesConfig.rules` の存在確認と `enabled` フィルタは妥当。`mask` のデフォルト値を `?? '***'` で明示しており、`chatFilter.ts` よりも構成的に安全。 |
| functions/filterText.ts | テキストベースのフィルタ処理。正規表現・文字列一致などを実装。 | 確認済 | `normalizeText` による NFKC 正規化と非文字・非数字除去は妥当。`filterText` は `getFilterRules` / `getMaskString` を使用し、構成的に安全。ただし `normalizeText` が `filterText` に未適用のため、フィルタ精度に差異が出る可能性あり。 |
| functions/index.ts | `functions/`配下のエントリーポイント。各フィルタ関数の統合・エクスポート。 | 確認済 | Firebase Functions の `onCall` による HTTPS callable 定義は妥当。`applyFilter` は `filterRules.ts` を介さず `rulesConfig` を直接参照しており、構成的に重複。フィルタロジックの一元化が望ましい。 |
| functions/config/filterRules.json | フィルタルール定義JSON。NGワード・カテゴリ・適用条件などを記述。 | 確認済 | `enabled: true` のルールのみ適用対象。`type` による分類は未使用。`mask: "※※※"` は明示されており、構成的に安全。ルールID・カテゴリ・語句の構造は妥当。 |
| src/ | アプリケーションのルート構成ディレクトリ。Vueコンポーネント・ロジック・設定群を統括。 | － | － |
| src/App.vue | ルートコンポーネント | 確認済 | `<router-view />` のみを描画する最小構成。`<script setup lang="ts">` による Composition API 構成は妥当。グローバルUIの追加余地あり。構成的に問題なし。 |
| src/auth.ts | Firebase認証関連の初期化・ログイン処理。GitHub認証障害の原因箇所の可能性あり。 | 確認済 | `onAuthStateChanged` による認証状態監視と `signInAnonymously` のフォールバックは妥当。`firebaseApp` の依存も整合。ログ出力は開発向けであり、本番環境では抑制推奨。 |
| src/firebaseConfig.ts | Firebase初期設定 | 確認済 | `import.meta.env.VITE_*` による環境変数の参照は Vite構成と整合。`initializeApp(firebaseConfig)` による初期化も妥当。構成的に問題なし。 |
| src/i18n.ts | 国際化設定 | 確認済 | `createI18n({ legacy: false })` による Composition API 対応構成は妥当。`notificationMessage.json` の読み込みも整合。`locale: "en"` 固定のため、動的切替が必要な場合は拡張要。 |
| src/main.ts | Vueインスタンス初期化 | 確認済 | `createApp(App).use(router).mount('#app')` による基本構成は妥当。`App.vue` / `router.ts` との依存関係も整合。構成的に問題なし。 |
| src/main_ui.ts | UI初期化処理 | 確認済 | Vueアプリケーションのエントリポイント。router-viewを含むApp.vueを基点に、i18nおよびrouterを適用して #app にマウント。構成的に明確かつ再現性あり。 |
| src/router.ts | UIルーティング構成 | 確認済 | Vue Router による SPAルーティング定義。開発用ページ群（dev/*）とUIページ（ui/chat/*）を明示的に分離。router-view による再現性確保済。createWebHistory により履歴管理も明示。 |
| src/vue-shim.d.ts | 型定義補完 | 確認済 | TypeScript における *.vue ファイルの型補完用 shim。DefineComponent により Vue SFC の型安全性を最低限確保。IDE補完・ビルド整合性の再現性に寄与。 |
| src/assets/ | アイコン・画像・i18nメッセージなどの静的リソース配置ディレクトリ。 | － | － |
| src/assets/chartIcons.ts | アイコン定義 | 確認済 | 各チャート種別に対応するSVG文字列を定義。再現性のある構成であり、getChartIcon による明示的取得関数も提供。UI描画における品質・構成責任を分離管理。 |
| src/assets/i18n/notificationMessage.json | 多言語通知メッセージ定義 | 確認済 | ja・en・zh の3言語に対応した通知文言を error / connection / status / chat に分類して定義。i18n構成の再現性・品質保証に寄与。キー構成も明示的で構成責任明確。 |
| src/chat/ | チャット処理ロジック群の配置ディレクトリ。フィルタ・履歴・統計処理を含む。 | － | － |
| src/chat/chartLabelMap.ts | チャート種別ラベル定義 | 確認済 | ja・en 対応のチャート種別ラベルと iconKey を定義。chartIcons.ts との照合性あり。UI表示とアイコン描画の構成責任を分離管理。再現性・品質観点ともに明確。 |
| src/chat/chatService.ts              | チャットテキストのフィルタ処理           | 確認済   | showToast に委譲構成・通知メッセージ分岐制御あり |
| src/chat/eventClassifier.ts | チャットイベント分類ロジック | 確認済 | `ChatEvent` を `SYSTEM` / `ACTION` / `INFO` に分類し、`groupByType` により型別グルーピングを構成。判定条件は明確かつ網羅的で、初期値も型安全に定義済。 |
| src/chat/filterContext.ts | チャットテキストのフィルタ適用 | 確認済 | `getFilterRules` に基づき、匿名ユーザー条件付きでフィルタ語をマスク。`flagged` 判定・`matchedTerms` 記録・`masked` 出力が明確に分離され、再現性あり。`isNonViolationEvent` による違反有無判定も明快。 |
| src/chat/historyWriter.ts | チャット履歴のRTDB書き込み | 確認済 | `ChatEvent` の `timestamp` / `type` / `text` を Firebase RTDB の `history` ノードへ `push`。DB取得は `getRTDB` に委譲され、責務分離済。非同期処理も明確。 |
| src/chat/reportBuilder.ts | チャットイベントレポート生成 | 確認済 | `ChatEvent[]` を `filterEvents` → `groupByType` で整形し、`statistics` / `history` / `markdown` / `json` の各形式で出力。各フォーマット関数は責務分離され、再現性・構成明示性あり。 |
| src/chat/reportLogger.ts | チャットレポートの整形・ログ出力 | 確認済 | `ChatEvent[]` の `text` を `formatMessage` で整形し、`writeLog` により `chat_report` として記録。整形・出力の責務分離が明確で、再現性あり。 |
| src/chat/sessionTypes.ts | チャットセッション型定義 | 確認済 | `sessionId` / `userId` / `messages[]` を含む `ChatSessionData` 型を定義。`messages` は `content` / `timestamp` を持ち、構成責任が明確。 |
| src/chat/statisticsAggregator.ts | 統計集計ロジック | 確認済 | 任意配列 `data[]` から `type` 別集計・セッション数・メッセージ数・ユニークユーザー数を集計。`chartLabelMap` から日本語ラベルを取得し、`AggregatedStatistics` として構成。再現性・構成責任ともに明確。 |
| src/chat/statisticsTypes.ts | 統計構造型定義 | 確認済 | `AggregatedStatistics` 型として、合計セッション数・メッセージ数・アクティブユーザー数・チャートラベル・チャート種別・集計データを定義。構成責任が明確で再現性あり。 |
| src/components/ | UI部品群の配置ディレクトリ。チャート・通知・入力UIなどを含む。 | － | － |
| src/components/ChartDisplay.vue | チャート種別選択UI | 確認済 | `chartTypeList` に基づく `<select>` により種別選択を構成。選択変更は `onTypeChange` 経由で親へ通知。`chartIcon` は `getChartIcon` により動的取得され、構成責任分離済。 |
| src/components/ui/ |  | － |  |
| src/components/ui/toastUI.vue | トースト通知UI。statusに応じたアイコン・メッセージ表示を制御。 | 確認済 | 表示制御・構成責任・スタイル定義ともに妥当。構成不備なし。 |
| src/config/ | 設定ファイル群の配置ディレクトリ。チャット・Firebase・公開設定などを含む。 | － | － |
| src/config/chatConfig.ts | 初期チャットメッセージ定義。表示候補の静的配列を保持。 | 確認済 | 配列定義のみで構成不備なし。役割と実装が一致。 |
| src/config/config.ts | 統合定数構成。APIエンドポイント・UI補助定数・制限値などを定義。 | 確認済 | 定数群の定義が明確で役割と一致。構成不備なし。 |
| src/config/firebase.ts | Firebase初期化構成。SDKを用いてアプリインスタンスを生成。 | 確認済 | 初期化構成は妥当。ダミーキー使用により公開安全性も確保。 |
| src/config/publishConfig.ts | 公開環境設定。環境種別・ログ出力・バージョン・チャート構成を定義。 | 確認済 | 型定義と初期値が明確。構成不備なし。役割と一致。 |
| src/data/ | 静的データ定義群の配置ディレクトリ。チャート種別などを保持。 | － | － |
| src/data/chartTypeList.ts | チャート種別一覧定義。表示・選択用の静的リストを保持。 | 確認済 | 配列定義のみで構成不備なし。役割と実装が一致。 |
| src/dev/ | テスト用UI群の配置ディレクトリ。機能検証・表示確認に使用。 | － | － |
| src/dev/chartSwitcher.vue | チャート種別切替UI。アイコン表示と選択状態を制御し、storeに反映。 | 確認済 | 表示・選択・状態同期が明確。構成不備なし。役割と一致。 |
| src/dev/chartTestPage.vue | チャート表示テストページ。表示種別の切替挙動を検証。 | 確認済 | 表示種別の状態管理と子コンポーネント連携が明確。構成不備なし。 |
| src/dev/deployStatus.vue | デプロイ状態表示。pending / success / failed に応じたメッセージを表示。 | 確認済 | 状態分岐・表示制御が明確。仮実装ながら構成不備なし。 |
| src/dev/logTester.vue | ログ送信検証。ユーザー操作ログを送信し、記録機能を確認。 | 確認済 | ログ送信関数の呼び出しが明確。構成不備なし。役割と一致。 |
| src/dev/mainTestPage.vue | 統合UI検証ページ。Phaser描画・チャットUI・アバター同期処理を統合確認。 | 確認済 | 描画・UI・通信初期化が明確。構成不備なし。役割と一致。 |
| src/dev/reportTester.vue | 分類レポート検証。表示形式選択に応じたレポート生成を確認。 | 確認済 | 表示形式の切替・非同期生成処理が明確。構成不備なし。 |
| src/dev/reportViewer.vue | レポート表示UI。形式選択・フィルター・統計描画に対応。 | 確認済 | 表示分岐・フィルター処理・チャート描画が明確。構成不備なし。 |
| src/dev/statsChart.vue | 統計チャート描画UI。bar / line / pie に応じたSVG描画を実装。 | 確認済 | 描画分岐・スケール計算・座標生成が明確。構成不備なし。 |
| src/dev/testLogger.vue | NG検出ログ検証。フィルター適用・匿名状態・ログ送信処理を確認。 | 確認済 | 入力検証・フィルター分岐・ログ記録処理が明確。構成不備なし。 |
| src/dev/testNotification.vue | フィルター通知検証。NG検出・マスク処理・匿名状態に応じた通知表示。 | 確認済 | フィルター分岐・表示制御が明確。構成不備なし。役割と一致。 |
| src/firebase/ | Firebase関連処理群の配置ディレクトリ。初期化・同期・書込・削除などを担う。 | － | － |
| src/firebase/init.ts | Firebase初期化。全構成項目を含む完全定義により接続設定を網羅。 | 確認済 | 項目網羅・初期化処理ともに妥当。構成不備なし。役割と一致。 |
| src/firebase/listen.ts | Firebaseリアルタイム監視。プレイヤー座標を監視し、更新通知を実行。 | 確認済 | 監視・分岐・通知処理が明確。構成不備なし。役割と一致。 |
| src/firebase/remove.ts | Firebase削除監視。プレイヤー離脱を検知し、UIDを通知。 | 確認済 | 監視・UID抽出・通知処理が明確。構成不備なし。役割と一致。 |
| src/firebase/rtdbConfig.ts | Firebase RTDB構成。初期化とDB取得関数を分離定義。 | 確認済 | 初期化・関数定義ともに明確。構成不備なし。役割と一致。 |
| src/firebase/sync.ts                 | プレイヤー状態の同期／RTDB書き込み       | 確認済   | getDiffs → emit 経由で差分通知／座標更新構成済 |
| src/firebase/write.ts | Firebase書き込み処理。UID単位でプレイヤー情報（座標・状態）を登録。 | 確認済 | 書き込み構成・項目定義が明確。構成不備なし。役割と一致。 |
| src/handlers/                     | メッセージ・イベント等のハンドラ群配置ディレクトリ。受信・分岐処理を担う。 | － ||
| src/handlers/messageHandler.ts       | ユーザー切断／退出の通知・ログ送信処理  | 確認済   | emitToast による通知表示・logEvent による追跡記録 |
| src/helpers/                      | 補助関数群の配置ディレクトリ。ストレージ・ユーティリティ処理を含む。 | － ||
| src/helpers/storageHelper.ts | Bot別メッセージ履歴の保存・読込・存在確認。localStorageを使用。 | 確認済 | 保存・読込・存在確認の各関数が明確に分離され、例外処理も完備。 |
| src/lib/                          | ライブラリ的構成要素の配置ディレクトリ。共通処理の統合管理。 | － ||
| src/lib/storageManager.ts | ストレージ管理モジュール。保存・読込の抽象化予定。 | 未実装 | 実装未着手。役割定義のみ確認。構成検証不可。 |
| src/log/                          | ログ処理関連の構成ディレクトリ。イベント記録・出力制御を含む。 | － ||
| src/log/genericEventLogger.ts | 汎用イベントログ記録。構造化されたイベントをパス付きで記録。フィルター・操作ログ対応。 | 確認済 | ログ構造・パス生成・フィルター連携が明確。構成不備なし。 |
| src/log/rtdbAdapter.ts | RTDB保存処理とStep履歴のMarkdown変換。保存は抽象化、Markdownはテンプレート準拠で整形。 | 確認済 | 保存処理は抽象化済。Markdown形式は日付整形含めテンプレート準拠。構成不備なし。 |
| src/logs/                         | ログ出力成果物の配置ディレクトリ。外部出力・保存対象。 | － ||
| src/logs/outputLogger.ts | 出力ログラベル生成と条件付きログ出力。publish設定に基づきラベル構築・出力制御。 | 確認済 | ラベル構築はtype/deployに準拠。出力は設定フラグで制御。構成不備なし。 |
| src/pages/                        | ページ単位のルーティング構成ディレクトリ。SPAルートと対応。 | － ||
| src/pages/dev/ || － ||
| src/pages/dev/chartTestPage.ts | ChartTestPageのVueアプリ初期化とDOMマウント。 | 確認済 | Vue標準構成で初期化・マウント処理を実装。構成不備なし。 |
| src/pages/dev/chartTestPage.vue | ChartTestPageのテンプレート定義。チャート表示領域とスタイルを含み、ロジックは未実装。 | 確認済 | テンプレート・スタイルは明確。スクリプトは未実装だが構成上問題なし。 |
| src/scenes/                          | メタバース風UIのシーン構成ディレクトリ。表示状態の管理を担う。 | － ||
| src/scenes/MainScene.ts | Phaserシーン定義。プレイヤー同期・Firebase連携・UI初期化・他プレイヤー描画・削除対応。 | 確認済 | preload/create/updateの構成明確。Firebase連携・UI初期化・描画管理に不備なし。 |
| src/scenes/statusDisplay.ts          | 状態表示 UI の切り替え                   | 確認済   | DOM制御 → emitOperation によりシステム通知発行 |
| src/services/                          | サービスロジック群の配置ディレクトリ。UI通知・同期処理などを含む。 | － ||
| src/services/peerAvatarSync.ts | WebSocket経由でリモートアバター情報を同期・保持・取得。payload構造定義済。 | 確認済 | イベント受信・Map更新・取得関数が明確。構成不備なし。 |
| src/services/toastService.ts         | トースト表示のサービスロジック           | 確認済   | toastService.show / showToast 両方を exportし統合 |
| src/state/                          | 状態管理ストアの配置ディレクトリ。Pinia等による状態保持を担う。 | － ||
| src/state/sessionStore.ts | セッション状態の保存・復元。ローカルストレージを用いてteamFilterとlastClickedUidを管理。 | 確認済 | 保存・復元ともに構成明確。null安全性・JSON整合性も考慮済。構成不備なし。 |
| src/stores/                          | 状態管理ストア群の配置ディレクトリ。チャット・統計等の状態保持。 | － ||
| src/stores/chatStore.ts | チャット状態管理。履歴保存・インポート適用時にトースト通知を表示。 | 確認済 | Pinia構成・状態定義・アクション処理・通知表示に不備なし。 |
| src/stores/statisticsStore.ts | 統計チャートの種類とアイコン状態を管理。PiniaストアでchartTypeとchartIconを切替。 | 確認済 | 状態定義・アイコン切替処理ともに明確。構成不備なし。 |
| src/system/                          | システム制御ロジック群の配置ディレクトリ。ログ・監視制御などを含む。 | － ||
| src/system/logManager.ts | システムログのファイル書き込み・クリア処理。ログはタイムスタンプ付きで保存。 | 確認済 | 書き込み・削除処理ともに明確。ファイルパス構成も適正。構成不備なし。 |
| src/system/monitorStatus.ts | CPU・メモリ使用率に基づくシステム状態判定とアラート文生成。 | 確認済 | 判定条件・アラート文ともに明確。SystemStatus型定義も適正。構成不備なし。 |
| src/tests/                          | テストコード群の配置ディレクトリ。機能検証・出力確認に使用。 | － ||
| src/tests/reportOutputTest.ts | レポート出力の形式別テスト。mockイベントを用いてMarkdown・JSON等の出力を検証。 | 確認済 | テスト構成・形式切替・出力確認が明確。構成不備なし。 |
| src/tests/                          | テストコード群の配置ディレクトリ（重複記載）。 | － ||
| src/types/ || － ||
| src/types/i18nTypes.ts | 通知メッセージの国際化構造定義。言語・カテゴリ・キー単位でメッセージを管理。 | 確認済 | 階層構造・型定義ともに明確。i18n用途に適合。構成不備なし。 |
| src/types/json.d.ts | JSONファイルのインポート型定義。TypeScriptでRecord型として扱えるよう宣言。 | 確認済 | モジュール宣言・型定義ともに適正。構成不備なし。 |
| src/types/message.ts | チャットイベント型定義。メッセージ種別を列挙型で管理し、timestamp・text・typeを保持。 | 確認済 | MessageType列挙・ChatEvent構造ともに明確。構成不備なし。 |
| src/types/player.ts | プレイヤーデータ構造定義。uid・座標・任意の名前・絵文字・状態を保持。 | 確認済 | 必須・任意プロパティの構成明確。構成不備なし。 |
| src/ui/                          | UI描画ロジック群の配置ディレクトリ。表示制御・状態同期を担う。 | － ||
| src/ui/chartUIConnector.ts | チャート種別に応じたUIアイコンのバインド処理。DOM要素にアイコンHTMLを設定。 | 確認済 | getChartIcon連携・DOM操作ともに明確。責務分離コメントも適正。構成不備なし。 |
| src/ui/displayAbstraction.ts | チャート種別に応じた表示状態抽象化。可視性判定とグループ構成をpublish設定に基づき返却。 | 確認済 | 判定・構成処理ともに明確。責務分離・設定参照も適正。構成不備なし。 |
| src/ui/finalizeDisplay.ts | チャート種別に応じた表示構成要素の定義。typeに応じてUI部品群を返却。 | 確認済 | 種別分岐・構成要素定義ともに明確。fallbackも適正。構成不備なし。 |
| src/ui/groupControl.ts | グループ制御UIの初期化処理。現状はログ出力による仮実装。 | 確認済 | 初期化関数・引数受け渡しは明確。仮実装として構成不備なし。 |
| src/ui/historyStatusView.ts | 履歴統計表示用Canvas生成。設定サイズ・CSSクラスを付与して返却。 | 確認済 | サイズ指定・クラス付与ともに明確。構成不備なし。 |
| src/ui/statusDisplay.ts | ステータス表示更新。ラベル選定後、描画関数に委譲。 | 確認済 | ラベル選定・描画委譲ともに明確。構成不備なし。 |
| src/ui/statusRenderer.ts | ステータス描画処理。Canvas上のアバター描画・DOMラベル更新・テキスト変換を実装。 | 確認済 | 描画処理・アイコン選定・DOM更新ともに明確。構成不備なし。 |
| src/ui/teamSelector.ts               | チーム選択時のイベント発行               | 確認済   | emit("team-selected", ...) により選択イベント通知 |
| src/ui/updateStatusText.ts | フィルターキーに応じたステータステキスト生成。未定義キーはUncategorizedとして処理。 | 確認済 | ラベル判定・テキスト生成ともに明確。構成不備なし。 |
| src/ui/chat/ || － ||
| src/ui/chat/chatInput.vue | チャット入力UI。メッセージ送信・Bot応答連携・状態更新を含む。 | 確認済 | UI構成・入力処理・ストア連携・Bot応答呼び出しともに明確。構成不備なし。 |
| src/ui/chat/chatUI.vue | チャットUIの保存操作。保存処理実行後にトースト通知を表示。 | 確認済 | 保存処理・通知表示ともに明確。CSS未定義は構成上問題なし。 |
| src/utils/ | 汎用処理群の配置ディレクトリ。チャート・通知・差分処理などを含む。 | － ||
| src/utils/botRegistry.ts | Botプロファイル定義とレジストリ登録。replyHandlerによりBot応答生成。 | 確認済 | `BotProfile`型定義・`botRegistry`構成ともに明確。初期Bot応答も仕様通り。 |
| src/utils/botReplyHelper.ts | Bot応答生成補助関数。500ms遅延後に応答文字列を返却。 | 確認済 | `generateBotReply`・`delay`関数ともに仕様通り。仮処理として妥当。 |
| src/utils/chartRenderer.ts | Canvas 上に棒グラフを描画。データに基づきバー・ラベルを配置。 | 確認済 | `renderBarChart`関数は仕様通り。描画位置・色・ラベル処理も明確。 |
| src/utils/eventBus.ts                | 汎用イベント発行／トースト通知処理       | 確認済   | emit / emitToast / emitOperation それぞれ定義明確 |
| src/utils/formatMessage.ts | メッセージ文字列の整形。連続空白を単一化し前後空白を除去。 | 確認済 | `formatMessage`関数は仕様通り。正規表現処理も明確。 |
| src/utils/generateDiff.ts | 2つの Map<string, T> を比較し、追加・削除・更新キーを抽出。 | 確認済 | `generateDiff`関数は仕様通り。キー存在・内容差分ともに明確。JSON比較も妥当。 |
| src/utils/getNotificationText.ts | 通知メッセージを言語・カテゴリ・キーに基づき取得。 | 確認済 | `getNotificationText`関数は仕様通り。構造分解・存在判定も明確。 |
| src/utils/importHelper.ts | インポートファイルを読み取り、botIdとmessagesを抽出・検証。 | 確認済 | `parseImportFile`関数は仕様通り。型検証・例外処理・構造変換も明確。 |
| src/utils/nameEmojiMap.ts | UIDごとの名前・絵文字変更検知。変更時にキャッシュ更新。 | 確認済 | `hasNameOrEmojiChanged`関数は仕様通り。初回登録・差分検知・更新処理も明確。 |
| src/utils/nameEmojiMapper.ts | RTDB構造を UID → 表示名＋絵文字 の Map に変換。 | 確認済 | `nameEmojiMapper`関数は仕様通り。絵文字の有無対応も明確。 |
| src/utils/playerMap.ts | プレイヤー表示管理クラスと差分検知関数。Phaserオブジェクト操作含む。 | 確認済 | `PlayerVisualSet`クラス・`hasDiff`関数ともに仕様通り。位置更新・破棄・状態比較も明確。 |
| src/utils/playerStateTracker.ts | プレイヤー状態の差分抽出とキャッシュ更新。name・emoji・status を比較。 | 確認済 | `getDiffs`関数は仕様通り。差分抽出・キャッシュ更新処理ともに明確。 |
| src/utils/statusMap.ts | ステータス変化検知・ラベル定義・UI連携用一覧生成。 | 確認済 | `hasStatusChanged`・`statusLabels`・`STATUS_LABELS` すべて仕様通り。変化検知・分類・連携処理も明確。 |
| src/utils/storageHelper.ts | Bot別メッセージ履歴の保存・読込・存在確認（localStorage使用）。 | 確認済 | `saveMessages`・`loadMessages`・`hasSavedMessages` すべて仕様通り。例外処理も明確。 |